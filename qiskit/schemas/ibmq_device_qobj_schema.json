{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "http://www.qiskit.org/schemas/ibm_backend_device_qobj_schema.json",
    "description": "OpenQuantum quantum object data structure for running experiments. IBM Backend specific instructions for experimental devices. Must also validate against qobj_schema.json",
    "version": "1.0.0",
    "definitions": {        
        "openqasm_instructions": {
            "oneOf": [
                { 
                    "properties": {
                        "name": {
                            "enum": ["snapshot", "reset", "barrier", "bfunc", "copy", "measure"]
                            }
                    }
                },                
                {
                    "properties": {
                        "memory": {
                            "maxItems": 0
                        },
                        "name": {
                            "enum": [
                                "u3",
                                "U"
                            ]
                        },
                        "params": {
                            "maxItems": 3,
                            "minItems": 3
                        },
                        "qubits": {
                            "maxItems": 1
                        },
                        "register": {
                            "maxItems": 0
                        },
                        "texparams": {
                            "maxItems": 3,
                            "minItems": 3
                        }
                    },
                    "required": [
                        "qubits",
                        "params"
                    ],
                    "title": "3-param 1Q gate"
                },
                {
                    "properties": {
                        "memory": {
                            "maxItems": 0
                        },
                        "name": {
                            "enum": [
                                "id"
                            ]
                        },
                        "params": {
                            "maxItems": 0
                        },
                        "qubits": {
                            "maxItems": 1,
                            "minItems": 1
                        },
                        "register": {
                            "maxItems": 0
                        },
                        "texparams": {
                            "maxItems": 0
                        }
                    },
                    "required": [
                        "qubits"
                    ],
                    "title": "fixed 1Q gate"
                },
                {
                    "properties": {
                        "memory": {
                            "maxItems": 0
                        },
                        "name": {
                            "enum": [
                                "u1",
                                "u0"
                            ]
                        },
                        "params": {
                            "maxItems": 1,
                            "minItems": 1
                        },
                        "qubits": {
                            "maxItems": 1,
                            "minItems": 1
                        },
                        "register": {
                            "maxItems": 0
                        },
                        "texparams": {
                            "maxItems": 1,
                            "minItems": 1
                        }
                    },
                    "required": [
                        "qubits",
                        "params"
                    ],
                    "title": "1-param 1Q gate"
                },
                {
                    "properties": {
                        "memory": {
                            "maxItems": 0
                        },
                        "name": {
                            "enum": [
                                "u2"
                            ]
                        },
                        "params": {
                            "maxItems": 2,
                            "minItems": 2
                        },
                        "qubits": {
                            "maxItems": 1,
                            "minItems": 1
                        },
                        "register": {
                            "maxItems": 0
                        },
                        "texparams": {
                            "maxItems": 2,
                            "minItems": 2
                        }
                    },
                    "required": [
                        "qubits",
                        "params"
                    ],
                    "title": "2-param 1Q gate"
                },
                {
                    "properties": {
                        "memory": {
                            "maxItems": 0
                        },
                        "name": {
                            "enum": [
                                "cx",
                                "CX"                                
                            ]
                        },
                        "params": {
                            "maxItems": 0
                        },
                        "qubits": {
                            "description": "[control, target]",
                            "maxItems": 2,
                            "minItems": 2
                        },
                        "register": {
                            "maxItems": 0
                        },
                        "texparams": {
                            "maxItems": 0
                        }
                    },
                    "required": [
                        "qubits"
                    ],
                    "title": "fixed 2Q gate"
                }                   
            ],            
            "required": [
                "name"
            ],
            "type": "object"
        },
        "qobjexp": {
            "description": "Quantum experiment",
            "properties": {
                "instructions": {
                    "description": "List of experiment instructions.",
                    "minItems": 1,
                    "type": "array"
                }
            },
            "required": [
                "instructions"
            ],
            "type": "object"
        },
        "qobj_qasm": {
            "properties": {
                "config": {
                    "description": "Configuration options that apply to all experiments in this qobj. For options that may be set on a per-experiment basis, these are the defaults. Use this space to set backend specific configuration requirements.",
                    "title": "Qobj-level configuration",
                    "type": "object"
                },
                "experiments": {
                    "description": "List of experiments to run",
                    "minItems": 1,
                    "type": "array"
                },
                "header": {
                    "_constraints": "sum(x[1] for x in clbit_labels) == number_of_clbits",
                    "description": "QObj metadata that does not affect how the experiments are run on the backend. Carried through to the result.",
                    "type": "object"
                }
            },
            "required": [
                "type",
                "experiments",
                "config",
                "header"
            ],
            "type": "object"
        }
    },
    "oneOf": [
        {
            "allOf": [
                {
                    "$ref": "#/definitions/qobj_qasm"
                },
                {
                    "properties": {
                        "experiments": {
                            "items": {
                                "allOf": [
                                    {
                                        "$ref": "#/definitions/qobjexp"
                                    },
                                    {
                                        "properties": {
                                            "instructions": {
                                                "items": {
                                                    "$ref": "#definitions/openqasm_instructions"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "type": {
                            "enum": [
                                "QASM"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "allOf": [
                {
                    "$ref": "#/definitions/qobj_qasm"
                },
                {
                    "properties": {"type": {"enum": ["PULSE"]}}
                }
            ]
        }
    ]
}
